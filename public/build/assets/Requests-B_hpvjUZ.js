var g=Object.defineProperty;var b=(a,o,n)=>o in a?g(a,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[o]=n;var p=(a,o,n)=>(b(a,typeof o!="symbol"?o+"":o,n),n);import{j as t}from"./StatisticCard-Bdo2C3ON.js";import{r as u}from"./index-DFv2mRv-.js";import{c as j}from"./ReactAppend-CwiwA4iz.js";import{B as R}from"./Base-D2jNg5O4.js";import{C as w}from"./CreateReactScript-yWJ4gJYl.js";import{T as v,R as c}from"./ReactAppend-B_xoNf1Y.js";import{D as h}from"./DxButton-DV0H-ZcL.js";import{B as N}from"./Content-DtiuTMAn.js";import{S as d}from"./sweetalert2.all-DCeKQPlA.js";import{r as C}from"./DxBox-PA__dqjs.js";import{i as B}from"./tippy-react.esm-BVvHiWwH.js";import{M as F}from"./Modal-B7I3CfuU.js";import"./index-DgyC5pTR.js";/* empty css              */import"./main-BBbUrZUL.js";import"./___vite-browser-external_commonjs-proxy-BQdpDcDf.js";import"./index.esm-B502ZfUP.js";/* empty css               */import"./InputFormGroup-z0D3_N8V.js";import"./SelectFormGroup-YFq90T3z.js";import"./Modal-C6W508ew.js";class S extends N{constructor(){super(...arguments);p(this,"path","coach/requests")}}const f=new S,T=()=>{const a=u.useRef(),[o,n]=u.useState(null),x=async s=>{const{value:e}=await d.fire({title:"Rechazar solicitud",html:C(t.jsxs("div",{style:{fontSize:"medium"},children:[t.jsxs("div",{className:"form-group mb-2",children:[t.jsx("label",{htmlFor:"reason-select",style:{marginBottom:"4px"},children:"Razón"}),t.jsxs("select",{id:"reason-select",className:"form-select",style:{width:"100%"},children:[t.jsx("option",{value:"",children:"Seleccione una razón"}),t.jsx("option",{value:"sin-accion",children:"Contacto sin acción"}),t.jsx("option",{value:"no-contacto",children:"No se pudo contactar"}),t.jsx("option",{value:"otro",children:"Otro"})]})]}),t.jsxs("div",{className:"form-group",id:"other-reason",style:{display:"none"},children:[t.jsx("label",{htmlFor:"other-reason-input",style:{marginBottom:"4px"},children:"Especifique"}),t.jsx("textarea",{id:"other-reason-input",className:"form-control",placeholder:"Especifique la razón",style:{minHeight:"27px",fieldSizing:"content"}})]})]})),focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",didOpen:()=>{$("#reason-select").select2({dropdownParent:$(".swal2-container"),width:"100%"}),$("#reason-select").on("change",function(){const r=$("#other-reason");$(this).val()==="otro"?r.show():r.hide()}),$(".select2-container").css("width","100%")},preConfirm:()=>{const r=$("#reason-select").val(),m=$("#other-reason-input").val();return r?r==="otro"&&!m.trim()?(d.showValidationMessage("Por favor, especifique la razón"),!1):{selectedReason:r,otherReason:r==="otro"?m:""}:(d.showValidationMessage("Por favor, seleccione una razón"),!1)}});if(!e)return;let i;switch(e.selectedReason){case"sin-accion":i="Contacto sin acción";break;case"no-contacto":i="No se pudo contactar";break;case"otro":i=e.otherReason;break}await f.save({id:s,status:null,status_message:i})&&$(a.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(v,{gridRef:a,title:"Solicitudes",rest:f,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"coachee.name",caption:"Nombres"},{dataField:"coachee.lastname",caption:"Apellidos"},{dataField:"coachee.email",caption:"Correo"},{dataField:"coachee.phone",caption:"Telefono",cellTemplate:(s,{data:e})=>{var i,l,r;(i=e==null?void 0:e.coachee)!=null&&i.phone?s.text(`${((l=e==null?void 0:e.coachee)==null?void 0:l.phone_prefix)||"51"}${((r=e==null?void 0:e.coachee)==null?void 0:r.phone)||""}`):c(s,t.jsx("i",{className:"text-muted",children:"- Sin telefono -"}))}},{dataField:"updated_at",caption:"Fecha",dataType:"date",cellTemplate:(s,{data:e})=>{s.text(moment(e.updated_at).format("LL"))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(s,{data:e})=>{switch(e.status){case 1:c(s,t.jsx("span",{className:"badge bg-success rounded-pill",children:"Atendido"}));break;case 0:c(s,t.jsx("span",{className:"badge bg-dark rounded-pill",children:"Pendiente"}));break;default:c(s,t.jsx("span",{className:"badge bg-danger rounded-pill",children:"Rechazado"}));break}e.status==null&&c(s,t.jsx(B,{content:e.status_message,children:t.jsx("p",{className:"mb-0 text-truncate text-muted",children:e.status_message})}))}},{caption:"Acciones",cellTemplate:(s,{data:e})=>{s.css("text-overflow","unset"),e.status==0&&(s.append(h({className:"btn btn-xs btn-soft-primary",title:"Redactar acuerdo",icon:"fa fas fa-file-signature",onClick:()=>n({request_id:e.id})})),s.append(h({className:"btn btn-xs btn-soft-danger",title:"Rechazar",icon:"fa fa-times",onClick:()=>x(e.id)})))},allowFiltering:!1,allowExporting:!1}]}),t.jsx(F,{dataLoaded:o,setDataLoaded:n,onSave:()=>$(a.current).dxDataGrid("instance").refresh()})]})};w((a,o)=>{j(a).render(t.jsx(R,{...o,title:"Solicitudes",children:t.jsx(T,{...o})}))});
